<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>さくらのうた</title>

<style>
html, body {
    margin: 0;
    padding: 0;
    background: transparent;
    width: 100%;
    height: 100%;
    font-family: -apple-system, BlinkMacSystemFont, "Hiragino Sans", sans-serif;
}

/* 让卡片占满 iframe */
.card {
    width: 100%;
    min-height: 130px;
    padding: 18px 20px;
    display: flex;
    align-items: center;
    gap: 18px;
    box-sizing: border-box;
    transition: background 0.6s ease, box-shadow 0.6s ease;
}

/* 封面 */
.cover {
    width: 95px;
    height: 95px;
    border-radius: 10px;
    object-fit: cover;
    flex-shrink: 0;
}

/* 信息 */
.info {
    flex: 1;
    min-width: 0;
}

.title {
    color: white;
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 6px;
    line-height: 1.3;
}

.artist {
    color: rgba(255,255,255,0.75);
    font-size: 13px;
    margin-bottom: 12px;
}

audio {
    width: 100%;
    filter: invert(1);
}
</style>
</head>

<body>

<div class="card" id="card">
    <img src="src/hqdefault.JPG" class="cover" id="cover">

    <div class="info">
        <div class="title">さくらのうた（木管五重奏）</div>
        <div class="artist">福田洋介⧸森の五重奏団</div>

        <audio controls loop>
            <source src="src/BGM.m4a" type="audio/mp4">
        </audio>
    </div>
</div>

<script>
const img = document.getElementById('cover');
const card = document.getElementById('card');

img.onload = function() {

    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');

    const size = 80;
    canvas.width = size;
    canvas.height = size;

    ctx.drawImage(img, 0, 0, size, size);

    const data = ctx.getImageData(0, 0, size, size).data;

    let r = 0, g = 0, b = 0;
    let count = 0;

    for (let i = 0; i < data.length; i += 4) {
        r += data[i];
        g += data[i+1];
        b += data[i+2];
        count++;
    }

    r = Math.floor((r / count) * 0.7);
    g = Math.floor((g / count) * 0.7);
    b = Math.floor((b / count) * 0.7);

    card.style.background =
        `linear-gradient(90deg, rgb(${r},${g},${b}), rgb(${r*0.6},${g*0.6},${b*0.6}))`;

    card.style.boxShadow =
        `0 4px 20px rgba(${r},${g},${b},0.35)`;
};
</script>

</body>
</html>
